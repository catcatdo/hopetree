:root {
  --bg-color: #87CEEB; /* Sky Blue */
  --trunk-color: #5d4037;
  --foliage-color-1: #2e7d32;
  --text-color: #333;
  --primary-btn: #ff6f61;
}

body {
  font-family: 'NeoDunggeunmo', monospace; /* Pixel Font */
  margin: 0;
  padding: 0;
  background-color: var(--bg-color);
  color: var(--text-color);
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  image-rendering: pixelated; /* Crisp pixels */
  -webkit-font-smoothing: none;
}

#app {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
}

header {
  text-align: center;
  padding: 20px;
  z-index: 10;
  width: 100%;
  /* Pixel art header style */
  background: #fff;
  border-bottom: 4px solid #000;
}

header h1 {
  margin: 0;
  font-size: 1.5rem;
  color: #000;
  text-shadow: 2px 2px 0px #ccc;
}

header p {
  margin: 5px 0 0;
  font-size: 0.8rem;
  color: #333;
}

/* Tree Container */
#tree-container {
  flex-grow: 1;
  width: 100%;
  position: relative;
  display: flex;
  justify-content: center;
  align-items: flex-end; /* Root at bottom */
  transition: all 1s steps(5); /* Stepped animation for retro feel */
  overflow: visible;
  /* 0 = Sapling, 1 = Full Grown (500 comments) */
  --growth-factor: 0; 
}

/* Sky & Clouds (Blocky) */
#sky-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 60%;
  z-index: 0;
  pointer-events: none;
  overflow: hidden;
}

.cloud {
  position: absolute;
  background: white;
  opacity: 0.9;
  animation: floatCloud linear infinite;
  /* Blocky Cloud Shape using box-shadow */
  width: 40px; 
  height: 10px;
  box-shadow: 
    10px -10px 0 0 white,
    20px -10px 0 0 white,
    30px 0 0 0 white,
    10px 10px 0 0 white,
    -10px 0 0 0 white;
}

/* Remove pseudo-elements used for rounded clouds */
.cloud::after, .cloud::before { content: none; }

.c1 { top: 20%; left: -120px; animation-duration: 25s; transform: scale(4); }
.c2 { top: 40%; left: -80px; animation-duration: 35s; animation-delay: 5s; transform: scale(3); }
.c3 { top: 30%; left: -100px; animation-duration: 30s; animation-delay: 15s; transform: scale(3.5); }

@keyframes floatCloud {
  0% { left: -200px; }
  100% { left: 110vw; }
}

/* Tree Trunk - Blocky & Minecraft Style */
.tree-trunk {
  /* Interpolate width */
  width: calc(40px + (120px - 40px) * var(--growth-factor));
  /* Interpolate height */
  height: calc(100px + (300px - 100px) * var(--growth-factor));
  
  background-color: #5d4037;
  /* Pixel texture pattern */
  background-image: 
    linear-gradient(90deg, rgba(0,0,0,0.2) 20%, transparent 20%),
    linear-gradient(rgba(0,0,0,0.1) 20%, transparent 20%);
  background-size: 10px 100%, 100% 10px;
  
  position: absolute;
  bottom: 60px; /* Lifted up to sit on ground */
  /* No border radius */
  z-index: 1;
  border: 4px solid #3e2723; /* Outline */
  box-sizing: border-box;
}

/* Tree Foliage - Minecraft Pyramid Style */
.tree-foliage {
  /* Interpolate size */
  width: calc(160px + (640px - 160px) * var(--growth-factor));
  height: calc(200px + (800px - 200px) * var(--growth-factor));
  /* Adjust bottom to account for lifted trunk (80px + 60px trunk base = 140px approx start) */
  bottom: calc(140px + (250px - 80px) * var(--growth-factor));

  background: #2e7d32;
  /* Pixel texture */
  background-image: 
    linear-gradient(90deg, rgba(255,255,255,0.1) 10%, transparent 10%),
    linear-gradient(rgba(0,0,0,0.1) 10%, transparent 10%);
  background-size: 20px 20px;
  
  position: absolute;
  z-index: 2;
  
  /* Stepped Pyramid Clip Path */
  /* Creates a blocky triangle look */
  clip-path: polygon(
    40% 0%, 60% 0%, 
    60% 20%, 80% 20%, 
    80% 40%, 100% 40%, 
    100% 100%, 
    0% 100%, 
    0% 40%, 20% 40%, 
    20% 20%, 40% 20%
  );
  
  /* Slight sway */
  animation: swayFoliage 5s steps(10) infinite alternate;
}

/* Ground & Pixel Char */
#ground-container {
  position: absolute;
  bottom: 0px; 
  width: 100%;
  height: 80px;
  background-image: 
    linear-gradient(#8b4513 50%, transparent 50%),
    linear-gradient(90deg, #8b4513 50%, transparent 50%);
  background-size: 40px 40px; /* Dirt blocks */
  background-color: #5d4037;
  z-index: 5;
  border-top: 4px solid #3e2723;
  overflow: visible; /* Allow cat to stand on top */
}

/* CSS Pixel Art Character (Tamagotchi / Blob) */
.pixel-char {
  width: 10px;
  height: 10px;
  position: absolute;
  bottom: 80px; /* Stand ON TOP of the 80px high ground */
  left: -20px;
  
  /* Pixel Art defined by Box Shadows */
  /* Base color: White, Eyes: Black */
  /* Frame 1 */
  box-shadow: 
    10px 0 #fff, 20px 0 #fff,
    0 10px #fff, 10px 10px #000, 20px 10px #fff, 30px 10px #000,
    0 20px #fff, 10px 20px #fff, 20px 20px #fff, 30px 20px #fff,
    10px 30px #fff, 30px 30px #fff; 
    /* Feet apart */
}

/* Walking Animation (Frame 2) */
@keyframes walkFrames {
  0% {
    box-shadow: 
      10px 0 #fff, 20px 0 #fff,
      0 10px #fff, 10px 10px #000, 20px 10px #fff, 30px 10px #000,
      0 20px #fff, 10px 20px #fff, 20px 20px #fff, 30px 20px #fff,
      10px 30px #fff, 30px 30px #fff; /* Feet apart */
  }
  50% {
    box-shadow: 
      10px 0 #fff, 20px 0 #fff,
      0 10px #fff, 10px 10px #000, 20px 10px #fff, 30px 10px #000,
      0 20px #fff, 10px 20px #fff, 20px 20px #fff, 30px 20px #fff,
      20px 30px #fff; /* Feet together/centered */
  }
}

.pixel-char {
  /* Apply walking frame animation */
  animation: runCat 15s linear infinite, walkFrames 0.5s steps(1) infinite;
  /* Scale 4x AND flip horizontally to face right */
  transform: scale(4) scaleX(-1); 
  transform-origin: bottom center;
}


@keyframes runCat {
  0% { left: -10vw; }
  100% { left: 110vw; }
}

/* Wind Animation (Stepped) */
@keyframes swayTrunk {
  from { transform: rotate(-1deg); }
  to { transform: rotate(1deg); }
}

@keyframes swayFoliage {
  from { transform: rotate(-2deg); }
  to { transform: rotate(2deg); }
}

/* Ribbons (Comments) - Pixel Style */
.fruit {
  position: absolute;
  width: 24px;
  height: 60px;
  background-color: #ffeb3b; 
  /* No border radius */
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding-top: 5px;
  font-size: 0.6rem; /* Smaller pixel font */
  color: #5d4037;
  z-index: 10;
  transform-origin: top center;
  animation: swayRibbon 3s steps(5) infinite alternate;
  writing-mode: vertical-rl; 
  text-orientation: upright;
  overflow: hidden;
  white-space: nowrap;
  
  border: 2px solid #000; /* Black outline */
  box-shadow: 4px 4px 0px rgba(0,0,0,0.2);
}

.fruit:hover {
  transform: scale(1.1) rotate(0deg) !important; 
  z-index: 20;
}

@keyframes swayRibbon {
  0% { transform: rotate(-5deg); }
  100% { transform: rotate(5deg); }
}

/* Tooltip/Modal - Pixel Style */
.message-popup { /* ... (if used) ... */ }

/* Input Section - Pixel Style */
#input-section {
  width: 100%;
  background: white;
  padding: 20px;
  box-shadow: 0 4px 0px rgba(0,0,0,0.1);
  display: flex;
  justify-content: center;
  z-index: 100;
  position: relative;
  border-bottom: 4px solid #000;
}

#message-form {
  display: flex;
  gap: 10px;
  width: 100%;
  max-width: 600px;
  align-items: center;
}

#username {
  padding: 10px;
  border: 4px solid #000;
  border-radius: 0;
  width: 80px;
  font-family: inherit;
}

#usermessage {
  flex-grow: 1;
  padding: 10px;
  border: 4px solid #000;
  border-radius: 0;
  resize: none;
  height: 40px;
  font-family: inherit;
}

button[type="submit"] {
  background-color: var(--primary-btn);
  color: white;
  border: 4px solid #000;
  padding: 0 20px;
  border-radius: 0;
  height: 68px; /* Match inputs + borders approx */
  cursor: pointer;
  font-weight: bold;
  font-family: inherit;
  box-shadow: 4px 4px 0 #000; /* Retro button shadow */
}
button[type="submit"]:active {
  transform: translate(4px, 4px);
  box-shadow: none;
}